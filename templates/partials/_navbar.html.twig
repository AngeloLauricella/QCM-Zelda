<header class="header header-shadow">
    <div class="header-content container">

        <!-- Logo -->
        <a href="{{ path('app_home') }}" class="header-logo">
            <img src="{{ asset('images/The_Legend_of_Zelda_Ocarina_of_Time_Logo.png') }}" alt="Logo QCM-Zelda">
        </a>

        <!-- Navigation desktop -->
        <nav class="navbar">
            <ul class="nav-menu">
                {% if is_granted('ROLE_USER') %}
                    {% set lastStep = app.user.player.lastStep ?? 0 %}

                    <li class="nav-item">
                        <a href="{{ lastStep > 0 ? path('game_step', {'step': lastStep}) : path('game_index') }}"
                           class="{% if app.request.attributes.get('_route') starts with 'game' %}active{% endif %}">
                            {{ lastStep > 0 ? 'Continuer l\'aventure' : 'Nouvelle aventure' }}
                        </a>
                    </li>

                    <li class="nav-item">
                        <a href="{{ path('app_profile_index') }}"
                           class="{% if app.request.attributes.get('_route') == 'app_profile_index' %}active{% endif %}">
                            Profil
                        </a>
                    </li>

                    <li class="nav-item">
                        <a href="{{ path('app_score_index') }}"
                           class="{% if app.request.attributes.get('_route') starts with 'app_score' %}active{% endif %}">
                            Scores
                        </a>
                    </li>

                    <li class="nav-item">
                        <a href="{{ path('gallery_index') }}"
                           class="{% if app.request.attributes.get('_route') starts with 'gallery' %}active{% endif %}">
                            Galerie
                        </a>
                    </li>

                    <li class="nav-item">
                        <a href="{{ path('gallery_shop_index') }}"
                           class="{% if app.request.attributes.get('_route') == 'gallery_shop_index' %}active{% endif %}">
                            Boutique
                        </a>
                    </li>
                {% endif %}
            </ul>
        </nav>

        <!-- Controls -->
        <div class="header-controls">
            {% if is_granted('ROLE_USER') %}
                <span class="score-display">
                    {{ app.user.username ?: app.user.email }}
                </span>
                <a href="{{ path('app_logout') }}" class="btn btn-secondary btn-sm">DÃ©connexion</a>
            {% else %}
                <a href="{{ path('app_login') }}" class="btn btn-primary btn-sm">Connexion</a>
                <a href="{{ path('app_register') }}" class="btn btn-accent btn-sm">S'inscrire</a>
            {% endif %}

            <!-- Toggle mobile -->
            <button class="header-toggle" id="mobileToggle" aria-label="Menu">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                          d="M4 6h16M4 12h16M4 18h16"/>
                </svg>
            </button>
        </div>
    </div>
</header>
