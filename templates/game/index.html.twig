{% extends 'base.html.twig' %}

{% block title %}Zelda: Ocarina of Time - Menu Principal
{% endblock %}

{% block body %}
	<header class="game-header">
		<h1>{{ player.name }}, bienvenue!</h1>
		<p class="subtitle">L'aventure t'attend</p>
	</header>

	<main
		class="game-main container_profile">

		<!-- Player Stats -->
		<section class="player-stats">
			<div class="hearts-display">
				<span class="label">CÅ“urs:</span>
				<div class="hearts-container">
					{% for i in 1..maxHearts %}
						<span class="heart{% if i <= hearts %} active{% endif %}">
							<img class="card-rubis" src="{{ asset('images/coeur.png') }}">
						</span>
					{% endfor %}
				</div>
				<span class="count">{{ hearts }}/{{ maxHearts }}</span>
			</div>
		</section>
		{% if isGameOver %}
			<!-- Game Over Section -->
			<section class="game-over-section">
				<h2>ðŸŽ® GAME OVER ðŸŽ®</h2>
				<div class="final-stats">
					<p class="game-over-reason">{{ gameOverReason ?? 'Tu as perdu tous tes cÅ“urs...' }}</p>
					<p class="final-score">Score Final:
						<strong>{{ points }}</strong>
						points</p>
					<p class="shop-points-earned">
						Points Boutique Ã  gagner:
						<strong>{{ (points / 10)|round(0, 'floor') }}</strong>
						ðŸ’Ž
					</p>
				</div>
				<div class="game-over-actions">
					<form action="{{ path('game_restart') }}" method="post">
						<button type="submit" class="btn btn-restart">Rejouer et Enregistrer le Score</button>
					</form>
					<a href="{{ path('app_score_index') }}" class="btn btn-scores">Voir les Classements</a>
					<a href="{{ path('gallery_shop_index') }}" class="btn btn-shop">ðŸ›’ Boutique</a>
				</div>
			</section>
		{% else %}
			<!-- Zones d'Aventure -->
			<section class="zones-container">
				<h2>Zones d'Aventure</h2>

				{% if progressionZones is empty %}
					<div class="intro-message">
						<h3>Bienvenue en Hyrule!</h3>
						<p>Ton aventure commence maintenant. Explore les terres d'Hyrule et rÃ©ponds aux dÃ©fis qui t'attendent!</p>
						<form action="{{ path('game_new') }}" method="post">
							<button type="submit" class="btn btn-start-adventure">ðŸŽ® Commencer l'Aventure</button>
						</form>
					</div>
				{% else %}
					{% for item in progressionZones %}
						{% set progressPercentage = item.progressPercentage > 100 ? 100 : item.progressPercentage %}
						<div class="zone-card
																															{% if item.isCurrent %}current{% elseif item.isCompleted %}completed{% else %}unlocked{% endif %}">
							<div class="zone-header">
								<h4>{{ item.zone.name }}</h4>
								{% if item.isCompleted %}
									<span class="zone-badge badge-completed">âœ“ COMPLÃ‰TÃ‰E</span>
								{% elseif item.isCurrent %}
									<span class="zone-badge badge-current">EN COURS</span>
								{% else %}
									<span class="zone-badge badge-unlocked">DÃ‰BLOQUÃ‰E</span>
								{% endif %}
							</div>

							<p class="zone-description">{{ item.zone.description }}</p>

							<div class="zone-stats-mini">
								<div class="stat">
									<span class="label">Questions:</span>
									<span class="value">{{ item.questionsAnswered }}/{{ item.totalQuestions }}</span>
								</div>
								<div class="stat">
									<span class="label">Score Zone:</span>
									<span class="value">{{ item.zoneScore }}</span>
								</div>
								<div class="stat">
									<span class="label">RÃ©ussite:</span>
									<span class="value">{{ progressPercentage|round }}%</span>
								</div>
							</div>

							{% if not item.isCompleted %}
								<a href="{{ path('game_zone_show', {'zoneId': item.zone.id}) }}" class="btn btn-primary btn-lg">
									{% if item.isCurrent %}â–¶Continuer les Questions{% else %}AccÃ©der Ã  la Zone
									{% endif %}
								</a>
							{% else %}
								<p class="zone-completed-message">Bravo, tu as complÃ©tÃ© cette zone!</p>
							{% endif %}
						</div>
					{% endfor %}

					<div class="locked-zones-info">
						<p class="info-text">ðŸ”’ Les autres zones se dÃ©verrouillent au fur et Ã  mesure de ta progression!</p>
					</div>
					<form action="{{ path('game_restart') }}" method="post">
						<button type="submit" class="btn btn-restart">Recommencer et Enregistrer le Score</button>
					</form>
				{% endif %}
			</section>

			<section class="player-stats">

				<div class="points-display">
					<span class="label">Points:</span>
					<span class="points-value">{{ points }}</span>
				</div>

				<div class="points-display">
					<span class="label">Points Boutique:</span>
					<span class="shop-points-value">{{ player.shopPoints }}</span>
					<img class="card-rubis" src="{{ asset('images/rupee-bourse.png') }}">
				</div>
				

			</section>

		{% endif %}
	</main>
{% endblock %}
