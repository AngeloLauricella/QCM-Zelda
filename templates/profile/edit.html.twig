{% extends 'base.html.twig' %}

{% block title %}Modifier Mon Profil - Zelda QCM
{% endblock %}

{% block body %}
	<div class="profile-container">
		<!-- Header -->
		<header class="profile-header">
			<div class="profile-header-content">
				<h1>‚úèÔ∏è Modifier Mon Profil</h1>
				<p class="subtitle">Mets √† jour tes informations personnelles</p>
			</div>
		</header>

		<!-- Main Content -->
		<main class="profile-main container_profile">
			<div class="profile-form-wrapper">
				<!-- Preview Avatar -->
				<aside class="profile-preview">
					<div class="preview-card">
						<h3>Aper√ßu</h3>
						<div class="avatar-preview-large">
							{% if app.user.profileImage %}
								<img src="{{ asset('uploads/profile/' ~ app.user.profileImage) }}" 
									 alt="{{ app.user.username }}"
									 id="avatarPreview"
									 class="avatar-preview-image">
							{% else %}
								<div class="avatar-preview-empty" id="avatarPreview">
									<span class="initials">{{ app.user.username[0:1]|upper }}</span>
								</div>
							{% endif %}
						</div>
						<p class="username-preview">{{ app.user.username }}</p>
						<p class="email-preview">{{ app.user.email }}</p>
					</div>
				</aside>

				<!-- Edit Form -->
				<div class="profile-form">
					<form action="{{ path('app_profile_edit') }}" method="POST" enctype="multipart/form-data" class="edit-form">
						<!-- Username Section -->
						<fieldset class="form-section">
							<legend>üë§ Nom d'Utilisateur</legend>
							<div class="form-group">
								<label for="username" class="form-label">Nom d'utilisateur</label>
								<input type="text" 
									   id="username"
									   name="username"
									   class="form-input"
									   value="{{ app.user.username }}"
									   minlength="3"
									   maxlength="50"
									   required>
								<small class="form-hint">Entre 3 et 50 caract√®res</small>
							</div>
						</fieldset>

						<!-- Email Section -->
						<fieldset class="form-section">
							<legend>‚úâÔ∏è Email</legend>
							<div class="form-group">
								<label for="email" class="form-label">Adresse Email</label>
								<input type="email" 
									   id="email"
									   name="email"
									   class="form-input"
									   value="{{ app.user.email }}"
									   required>
								<small class="form-hint">Nous ne partagerons jamais ton email</small>
							</div>
						</fieldset>

						<!-- Profile Image Section -->
						<fieldset class="form-section">
							<legend>üñºÔ∏è Photo de Profil</legend>
							<div class="form-group">
								<label for="profileImage" class="form-label">Importe une nouvelle photo</label>
								<div class="file-upload-wrapper">
									<input type="file" 
										   id="profileImage"
										   name="profileImage"
										   class="file-input"
										   accept="image/jpeg,image/png,image/gif,image/webp"
										   onchange="previewImage(event)">
									<label for="profileImage" class="file-upload-label">
										<svg class="upload-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
											<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
										</svg>
										<span class="upload-text">
											<strong>Clique pour importer</strong><br>
											<small>JPG, PNG, GIF ou WebP (max 5MB)</small>
										</span>
									</label>
								</div>
							</div>
						</fieldset>

						<!-- Actions -->
						<div class="form-actions">
							<button type="submit" class="btn btn-primary btn-lg">
								üíæ Enregistrer les modifications
							</button>
							<a href="{{ path('app_profile_index') }}" class="btn btn-secondary btn-lg">
								‚Ü©Ô∏è Annuler
							</a>
						</div>
					</form>

					<!-- Info Box -->
					<div class="info-box">
						<h4>‚ÑπÔ∏è Informations de S√©curit√©</h4>
						<ul>
							<li>Tu peux modifier ton nom d'utilisateur et ton email √† tout moment</li>
							<li>Assure-toi que ton email est valide pour la r√©cup√©ration de compte</li>
							<li>Ta photo de profil doit √™tre en JPG, PNG, GIF ou WebP (max 5MB)</li>
							<li>Si tu as oubli√© ton mot de passe, utilise l'option "Mot de passe oubli√©"</li>
						</ul>
					</div>
				</div>
			</div>
		</main>
	</div>

	<script>
		/**
		 * Pr√©visualiser l'image avant upload
		 */
		function previewImage(event) {
			const file = event.target.files[0];
			if (file) {
				const reader = new FileReader();
				reader.onload = function(e) {
					const preview = document.getElementById('avatarPreview');
					preview.innerHTML = '<img src="' + e.target.result + '" alt="Aper√ßu" class="avatar-preview-image">';
				};
				reader.readAsDataURL(file);
			}
		}
	</script>
{% endblock %}
